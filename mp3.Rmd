---
title: "Mini Project 3"
author: "Emily Kim, Dasom An, Janell Lin"
date: "4/15/2018"
output: 
  html_document:
  code_folding: hide
---

```{r, message = FALSE, warning = FALSE}
devtools::install_github("beanumber/macleish")
library(tidyverse)
library(macleish)
library (dplyr)
library(sf)
library(lwgeom)
library(leaflet)
require(leaflet)
```

```{r, warning=FALSE}
trails <- macleish_layers[["trails"]] %>%
  mutate(computed_length = st_length(geometry))
macleish_layers[["trails"]]

trails_1<- trails %>%
group_by(name) %>%
summarize(num_segments = n(),
total_length = sum(computed_length)) %>%
arrange(desc(total_length))

name <- c('Snowmobile Trail','Eastern Loop','Easy Out', "entry trail","Poplar Hill Road","Porcupine Trail", "Vernal Pool Loop","Western Loop")
numeric_rating <- c(47.73311, 24.99817, 2.4, 4.0, 21.49414,16.71984,5.4, 27.56704)

difficulty_rating <- data.frame(name, numeric_rating, stringsAsFactors=FALSE)%>%
mutate (Difficulty= if_else(as.numeric(numeric_rating)<10, "Easy", ifelse(as.numeric(numeric_rating)<30, "Moderate", "Hard")))

trails_2 <-trails_1 %>%
inner_join(difficulty_rating, by = "name")

```

```{r, message = FALSE, warning=FALSE}
contours <- macleish_layers[["contours_3m"]] %>%
  dplyr::select(ELEV_M, ELEV_FT, INDEX_ARC, SHAPE_LEN, geometry)

elevation_trail_xings <- macleish_layers[["trails"]] %>%
  st_intersection(macleish_layers[["contours_3m"]]) %>%
  dplyr::select(ELEV_M, ELEV_FT, INDEX_ARC, SHAPE_LEN, geometry, name, color) %>%
  dplyr::group_by(name) %>%
  dplyr::summarise(max = max(ELEV_FT), min = min(ELEV_FT), n = n()) %>%
  dplyr::mutate(difference = max - min)
```

```{r, message = FALSE, warning=FALSE}
landmarks<- macleish_layers[["landmarks"]]

pal <- colorNumeric(
palette = "Blues",
domain = contours$ELEV_M)

factpal <- colorFactor(topo.colors(3), palette = c('red', 'orange', 'green'),trails_2$Difficulty)


leaflet()%>%
 addTiles()%>%
 addPolylines(data=trails_2,
              weight = 5, fillOpacity = 0.5,
              popup = ~ name, group = "Structures",
              color = ~factpal(Difficulty))%>%
  addMarkers(data = macleish_layers[["landmarks"]],
             popup = ~ Label, group = "Structures")%>%
  addPolylines(data = contours, weight = 1, fillOpacity = 0.1, color = ~pal(ELEV_M))

```















