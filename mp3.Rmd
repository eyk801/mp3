---
title: "Mini Project 3"
author: "Emily Kim, Dasom An, Janell Lin"
date: "4/16/2018"
output: 
  html_document:
    code_folding: hide
---
For Mini Project 3, we decided to look at topic 1 and classify the difficulties of the trails in the Ada and Archibald MacLeish Field Station based on length and elevation.

Throughout this project, we analyzed multiple hiking difficulty standards and came across [this](https://www.nps.gov/shen/planyourvisit/how-to-determine-hiking-difficulty.htm) from the National Park Service. We used this as a guide to help us determine the hiking difficulty of the different trails in MacLeish. We found that all of the MacLeish trails are relatively easy based on the hiking difficulty standard from the National Park Service; so among the trails in MacLeish, we compared  their difficulty in relative to one another based on the length and elevation from our data. Thus, by referencing the National Park Service, we calculated the rating and used this numeric rating to determine the difficulty; since our highest numeric rating was 47, and easy is considered as a rating with less than 50, we had to adjust our scale. Ratings from 0-10 were considered easy, 10-30 were moderate numeric ratings, and hard were ratings higher than 30. 

```{r, message = FALSE, warning = FALSE}
#installing needed packages
devtools::install_github("beanumber/macleish")
library(tidyverse)
library(macleish)
library (dplyr)
library(sf)
library(lwgeom)
library(leaflet)
require(leaflet)
```

```{r, warning=FALSE, include=FALSE}
#Computing the length of each trail and ordering them
trails <- macleish_layers[["trails"]] %>%
  mutate(computed_length = st_length(geometry))
macleish_layers[["trails"]]

trails_1<- trails %>%
group_by(name) %>%
summarize(num_segments = n(),
total_length = sum(computed_length)) %>%
arrange(desc(total_length))


```

```{r, message = FALSE, warning=FALSE}

#calculate the change in elevation of each trail
contours <- macleish_layers[["contours_3m"]] %>%
  dplyr::select(ELEV_M, ELEV_FT, INDEX_ARC, SHAPE_LEN, geometry)

elevation_trail_xings <- macleish_layers[["trails"]] %>%
  st_intersection(macleish_layers[["contours_3m"]]) %>%
  dplyr::select(ELEV_M, ELEV_FT, INDEX_ARC, SHAPE_LEN, geometry, name, color) %>%
  dplyr::group_by(name) %>%
  dplyr::summarise(max = max(ELEV_FT), min = min(ELEV_FT), n = n()) %>%
  dplyr::mutate(difference = max - min)
```

```{r}

# Create new data frame that has the calculated difficulty rating based on formula from the National Park Services

name <- c('Snowmobile Trail','Eastern Loop','Easy Out', "entry trail","Poplar Hill Road","Porcupine Trail", "Vernal Pool Loop","Western Loop")
numeric_rating <- c(47.73311, 24.99817, 2.4, 4.0, 21.49414,16.71984,5.4, 27.56704)

difficulty_rating <- data.frame(name, numeric_rating, stringsAsFactors=FALSE)%>%
mutate (Difficulty= if_else(as.numeric(numeric_rating)<10, "Easy", ifelse(as.numeric(numeric_rating)<30, "Moderate", "Hard")))


#Joining the trails length data frame with the difficulty data frame
trails_2 <-trails_1 %>%
inner_join(difficulty_rating, by = "name")%>%
  arrange (desc(numeric_rating))%>%
  mutate(time= as.factor(ceiling(((total_length*2)/1.4)/60)))

```


Which Trail Do You Want To Take?
```{r, message = FALSE, warning=FALSE}

#plot contours, trails, and landmarks

#set color for the contours
pal <- colorNumeric(
  palette = c("light blue", "dark blue"),
  domain = contours$ELEV_M)

#set color for trails according to difficulty levels
factpal <- colorFactor(c('green', 'red', 'orange'),trails_2$Difficulty)

# set the popup of time to 'time needed to complete trail (minutes):' time
trails_2$time <- paste0('time needed to finish trail (minutes):', trails_2$time)


#code to plot contours, trails, and landmarks
leaflet()%>%
 addTiles()%>%
 addPolylines(data=trails_2,
              weight = 5, fillOpacity = 0.5,
              popup = ~ time, group = "Structures",
              color = ~factpal(Difficulty))%>%
  addMarkers(data = macleish_layers[["landmarks"]],
             popup = ~ Label)%>%
  addPolylines(data = contours, weight = 1, fillOpacity = 0.1, color = ~pal(ELEV_M))%>%
  addLegend(pal=factpal, values= trails_2$Difficulty, labels = "Easy", "Hard", "Moderate", title = "Trails Difficulty", position = 'bottomright')%>%
  addLegend(pal=pal,values=contours$ELEV_M,position = "bottomleft",title = "Elevation(meters)")

```

Because we found that all of the trails were considered easy, by the National Park Serviceâ€™s standards, we came to the conclusion that this is very family friendly for children and grandparents. Since this is friendly for children, we would recommend that the education department at Smith College would collaborate with local schools in the area. MacLeish would be a place for children to interact with nature and learn more about ecology, hydrology, and outdoor education.

Thinking about the resources necessary to implement the recommendation discussed above, we believe that this could be done in a relatively short time: implementing a program with local schools would probably not take too long, perhaps within a semester. The timing of the program could possibly take place in the fall semester or late spring semester for one day, or perhaps once a week depending on the scope of the program. We believe that this would cost little money, especially if there are student volunteers from Smith College willing to help teach students. As for the environmental impact, there could a possibility of increased trash at MacLeish: to prevent this, there could be an implementation of more trash cans in the area so families do not simply throw away their trash outside. The only roadblock we can foresee is transportation, and if there is no mode of transportation it would be difficult to get to the station. 

GitHub repository[^1]

[^1]:https://github.com/eyk801/mp3.git
